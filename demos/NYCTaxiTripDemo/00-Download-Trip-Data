# Databricks notebook source
# MAGIC %md
# MAGIC # Download NYC TLC Trip Record Data
# MAGIC 
# MAGIC This notebook downloads all NYC TLC Trip Record Data, also know as New York Taxi Data from <http://www.nyc.gov/html/tlc/html/about/trip_record_data.shtml>. The notebook downloads all available data until 2017.
# MAGIC 
# MAGIC >The yellow and green taxi trip records include fields capturing pick-up and drop-off dates/times, pick-up and drop-off locations, trip distances, itemized fares, rate types, payment types, and driver-reported passenger counts. The data used in the attached datasets were collected and provided to the NYC Taxi and Limousine Commission (TLC) by technology providers authorized under the Taxicab & Livery Passenger Enhancement Programs (TPEP/LPEP). The  trip data was not created by the TLC, and TLC makes no representations as to the accuracy of these data.
# MAGIC >
# MAGIC >The For-Hire Vehicle (“FHV”) trip records include fields capturing the dispatching base license number and the pick-up date, time, and taxi zone location ID (shape file below). These records are generated from the FHV Trip Record submissions made by bases. Note: The TLC publishes base trip record data as submitted by the bases, and we cannot guarantee or confirm their accuracy or completeness. Therefore, this may not represent the total amount of trips dispatched by all TLC-licensed bases. The TLC performs routine reviews of the records and takes enforcement actions when necessary to ensure, to the extent possible, complete and accurate information.
# MAGIC 
# MAGIC ## Errata
# MAGIC  
# MAGIC - 09/08/2017 - FHV trip record files from June 2017 updated as of 09/08/2017
# MAGIC - 08/30/2017 - FHV trip record files from July 2016 through June 2017 updated as of 08/16/2017
# MAGIC - 03/13/2017 - FHV trip record files from January 2016 through December 2016 updated as of 02/14/2017
# MAGIC - 09/22/2015 - TPEP and LPEP trip data CSVs from January through June 2015 have been updated to include a new field [improvement_surcharge] which lists the itemized portion of the fare covering the Taxicab Improvement Surcharge or Street Hail Livery Improvement Surcharge. This is a $0.30 surcharge on all trips to help fund accessibility in taxis and SHLs, which began on January 1, 2015. All TPEP and LPEP trip data files uploaded moving forward will also include this new field.
# MAGIC 
# MAGIC ---------------------------------------

# COMMAND ----------

# You need to create Azure Active Directory and service prinicpal first
# https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-create-service-principal-portal

clientId = dbutils.secrets.get(scope = "AzureKeyVault01", key = "databricks-adls-clientid")
credential = dbutils.secrets.get(scope = "AzureKeyVault01", key = "databricks-adls-credential")
refreshUrl = dbutils.secrets.get(scope = "AzureKeyVault01", key = "databricks-adls-refreshurl")
adlsurl = dbutils.secrets.get(scope = "AzureKeyVault01", key = "databricks-adls-url")

spark.conf.set("dfs.adls.oauth2.access.token.provider", "org.apache.hadoop.fs.adls.oauth2.ConfCredentialBasedAccessTokenProvider")
spark.conf.set("dfs.adls.oauth2.access.token.provider.type", "ClientCredential")
spark.conf.set("dfs.adls.oauth2.client.id", clientId)
spark.conf.set("dfs.adls.oauth2.credential", credential)
spark.conf.set("dfs.adls.oauth2.refresh.url", refreshUrl)

# COMMAND ----------

root_dir = "adl://" + adlsurl + "/RAW"
taxi_data_dir = root_dir + "/NYCTaxiTrips"
yellow_tripdata = taxi_data_dir + "/yellow_tripdata.csv"
green_tripdata = taxi_data_dir + "/green_tripdata.csv"
fhv_tripdata = taxi_data_dir + "/fhv_tripdata.csv"
lookup_data = taxi_data_dir + "/lookup.csv"
taxi_zones = taxi_data_dir + "/taxi_zones"
neighborhoods = taxi_data_dir + "/neighborhoods.geojson"

dbutils.fs.mkdirs(root_dir)
dbutils.fs.mkdirs(taxi_data_dir)
dbutils.fs.mkdirs(yellow_tripdata)
dbutils.fs.mkdirs(green_tripdata)
dbutils.fs.mkdirs(fhv_tripdata)
dbutils.fs.mkdirs(lookup_data)
dbutils.fs.mkdirs(taxi_zones)
dbutils.fs.mkdirs(neighborhoods)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2009-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2009-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2010-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2010-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2011-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2011-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2012-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2012-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2013-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2013-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2014-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2014-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2015-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2016-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2016-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2017-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-01.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-02.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-03.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-04.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-05.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-06.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-07.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-08.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-09.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-10.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-11.csv", yellow_tripdata)
dbutils.fs.mv("file:/databricks/driver/yellow_tripdata_2017-12.csv", yellow_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2013-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2013-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2013-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2013-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2013-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/green_tripdata_2013-08.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2013-09.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2013-10.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2013-11.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2013-12.csv", green_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2014-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-01.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-02.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-03.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-04.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-05.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-06.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-07.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-08.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-09.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-10.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-11.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2014-12.csv", green_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2015-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-01.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-02.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-03.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-04.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-05.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-06.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-07.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-08.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-09.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-10.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-11.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2015-12.csv", green_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2016-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-01.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-02.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-03.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-04.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-05.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-06.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-07.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-08.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-09.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-10.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-11.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2016-12.csv", green_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/green_tripdata_2017-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-01.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-02.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-03.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-04.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-05.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-06.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-07.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-08.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-09.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-10.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-11.csv", green_tripdata)
dbutils.fs.mv("file:/databricks/driver/green_tripdata_2017-12.csv", green_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2015-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-01.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-02.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-03.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-04.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-05.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-06.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-07.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-08.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-09.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-10.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-11.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2015-12.csv", fhv_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2016-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-01.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-02.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-03.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-04.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-05.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-06.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-07.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-08.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-09.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-10.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-11.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2016-12.csv", fhv_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-01.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-02.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-03.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-04.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-05.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-06.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-07.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-08.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-09.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-10.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-11.csv
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/trip+data/fhv_tripdata_2017-12.csv

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-01.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-02.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-03.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-04.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-05.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-06.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-07.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-08.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-09.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-10.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-11.csv", fhv_tripdata)
dbutils.fs.mv("file:/databricks/driver/fhv_tripdata_2017-12.csv", fhv_tripdata)

# COMMAND ----------

# MAGIC %sh
# MAGIC wget http://www.nyc.gov/html/tlc/downloads/pdf/data_dictionary_trip_records_yellow.pdf
# MAGIC wget http://www.nyc.gov/html/tlc/downloads/pdf/data_dictionary_trip_records_green.pdf
# MAGIC wget http://www.nyc.gov/html/tlc/downloads/pdf/data_dictionary_trip_records_fhv.pdf
# MAGIC   
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/misc/taxi+_zone_lookup.csv
# MAGIC   
# MAGIC wget https://s3.amazonaws.com/nyc-tlc/misc/taxi_zones.zip
# MAGIC wget http://www.nyc.gov/html/tlc/images/features/taxi_zone_map_bronx.jpg
# MAGIC wget http://www.nyc.gov/html/tlc/images/features/taxi_zone_map_brooklyn.jpg
# MAGIC wget http://www.nyc.gov/html/tlc/images/features/taxi_zone_map_manhattan.jpg
# MAGIC wget http://www.nyc.gov/html/tlc/images/features/taxi_zone_map_queens.jpg
# MAGIC wget http://www.nyc.gov/html/tlc/images/features/taxi_zone_map_staten_island.jpg
# MAGIC   
# MAGIC wget https://github.com/harsha2010/magellan/raw/master/examples/datasets/NYC-NEIGHBORHOODS/neighborhoods.geojson

# COMMAND ----------

# MAGIC %sh
# MAGIC unzip -q /databricks/driver/taxi_zones.zip

# COMMAND ----------

dbutils.fs.mv("file:/databricks/driver/data_dictionary_trip_records_yellow.pdf", taxi_data_dir)
dbutils.fs.mv("file:/databricks/driver/data_dictionary_trip_records_green.pdf", taxi_data_dir)
dbutils.fs.mv("file:/databricks/driver/data_dictionary_trip_records_fhv.pdf", taxi_data_dir)

dbutils.fs.mv("file:/databricks/driver/taxi+_zone_lookup.csv", lookup_data)

dbutils.fs.mv("file:/databricks/driver/taxi_zones.zip", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.prj", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.dbf", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.shp", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.shp.xml", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.shx", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.sbn", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zones.sbx", taxi_zones) 
dbutils.fs.mv("file:/databricks/driver/taxi_zone_map_bronx.jpg", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zone_map_brooklyn.jpg", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zone_map_manhattan.jpg", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zone_map_queens.jpg", taxi_zones)
dbutils.fs.mv("file:/databricks/driver/taxi_zone_map_staten_island.jpg", taxi_zones)

dbutils.fs.mv("file:/databricks/driver/neighborhoods.geojson", neighborhoods)

# COMMAND ----------

dbutils.fs.ls("file:/databricks/driver/")